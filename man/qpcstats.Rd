% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/qpc.R
\name{qpcstats}
\alias{qpcstats}
\title{Compute Quantitative Predictive Check (QPC) statistics}
\usage{
qpcstats(
  o,
  alpha = 0.05,
  w = c(med_cov = 0.35, tail_cov = 0.2, mae = 0.15, drift = 0.1, sharp = 0.1, interval =
    0.1),
  sharp_ref = NULL,
  interval_ref = NULL,
  ...
)
}
\arguments{
\item{o}{A \code{tidyvpcobj} produced by \code{\link{vpcstats}} (typically using
\code{\link{binless}} VPC summaries).}

\item{alpha}{Numeric. Miscoverage level for interval scoring (default \code{0.05}
corresponds to a 95\% prediction interval).}

\item{w}{Named numeric vector of weights used to combine component penalties into
\code{qpc_score}. Names must include:
\code{med_cov}, \code{tail_cov}, \code{mae}, \code{drift}, \code{sharp}, \code{interval}.
Lower \code{qpc_score} is better.}

\item{sharp_ref}{Numeric or \code{NULL}. Reference value used to scale the sharpness
(interval width) penalty. If \code{NULL} (default), a self-normalizing bounded
transform is used so that a single VPC can be scored without external calibration.
Set \code{sharp_ref} when you need scores to be comparable across a population
of models (e.g., Darwin searches, benchmarking across multiple datasets/runs).}

\item{interval_ref}{Numeric or \code{NULL}. Reference value used to scale the
interval-score penalty. If \code{NULL} (default), a self-normalizing bounded
transform is used. Set \code{interval_ref} for cross-model or cross-run comparability
(e.g., Darwin optimization or evaluation studies).}

\item{...}{Additional arguments (reserved for future extensions).}
}
\value{
Returns \code{tidyvpcobj} with an additional \code{qpc.stats}
\code{data.table} containing QPC summary metrics and \code{qpc_score}.
}
\description{
Compute quantitative predictive quality metrics that summarize agreement
between observed and simulated data in a VPC. QPC statistics numerically encode
features typically assessed visually (coverage, deviation, trend, and sharpness),
and include a composite \code{qpc_score} (lower is better) suitable for automated
model comparison and optimization.
}
\details{
\strong{When should I set \code{sharp_ref} / \code{interval_ref}?}
\itemize{
  \item \emph{Single-model / single-VPC scoring (default):} leave both as \code{NULL}.
  This produces stable, bounded penalties without requiring any prior run for calibration.
  \item \emph{Population scoring / optimization:} provide references when comparing many
  models (e.g., Darwin search) where you want the sharpness and interval-score penalties
  to be on a consistent scale across models/runs. A common choice is to compute
  \code{sharp_ref} and \code{interval_ref} from a representative run (e.g., median or 75th
  percentile values across all evaluated models).
}
}
\examples{
\dontrun{
vpc <- observed(obs_data, y = DV, x = TIME) \%>\%
  simulated(sim_data, y = DV) \%>\%
  binless(optimize = TRUE) \%>\%
  predcorrect(pred = PRED) \%>\%
  vpcstats()

# Default: single-model scoring (no calibration required)
vpc <- qpcstats(vpc)

# Population scoring (e.g., Darwin run): anchor penalties for comparability
vpc <- qpcstats(
  vpc,
  sharp_ref = 0.15,
  interval_ref = 2.5
)

vpc$qpc.stats
}

}
\seealso{
\code{\link{vpcstats}}, \code{\link{binless}}, \code{\link{predcorrect}}
}
